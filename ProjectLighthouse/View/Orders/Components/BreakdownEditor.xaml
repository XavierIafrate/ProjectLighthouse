<UserControl
    x:Class="ProjectLighthouse.View.Orders.Components.BreakdownEditor"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:ProjectLighthouse.View.Orders.Components"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:userControls="clr-namespace:ProjectLighthouse.View.UserControls"
    x:Name="parentControl"
    d:Background="White"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <TextBlock
            Margin="10,5,0,10"
            Style="{StaticResource section}"
            Text="Machine Breakdowns" />

        <Border
            Visibility="Collapsed"
            x:Name="AddNewBreakdownControls"
            Grid.Row="1"
            Margin="10,0"
            Padding="10,5"
            BorderBrush="{StaticResource Surface}"
            BorderThickness="2"
            CornerRadius="5">

            <StackPanel MaxWidth="400">
                <TextBlock
                    Margin="0,2,0,0"
                    Style="{StaticResource InputLabel}"
                    Text="Breakdown Code" />

                <ComboBox Margin="0" x:Name="BreakdownCodes_ComboBox">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding Id}" FontFamily="Consolas" FontWeight="SemiBold" Margin="0,1,0,0" VerticalAlignment="Center" FontSize="15"/>
                                <TextBlock Text="{Binding Name}" VerticalAlignment="Center" Margin="5,0" FontStyle="Italic"/>
                            </StackPanel>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <TextBlock
                    Margin="0,2,0,0"
                    Style="{StaticResource InputLabel}"
                    Text="Started" />
                <userControls:DateTimePicker Margin="0,0,5,5" DateTime="{Binding ElementName=parentControl, Path=NewBreakdown.BreakdownStarted, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}" />
                <TextBlock
                    Margin="0,2,0,0"
                    Style="{StaticResource InputLabel}"
                    Text="Ended" />
                <userControls:DateTimePicker Margin="0,0,5,5" DateTime="{Binding ElementName=parentControl, Path=NewBreakdown.BreakdownEnded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}" />
                <Button
                    x:Name="AddBreakdownButton"
                    HorizontalAlignment="Right"
                    Click="AddBreakdownButton_Click"
                    Content="Add"
                    Style="{StaticResource Action_New_Button_Small}" />
            </StackPanel>
        </Border>
        <ListView
            Grid.Row="2"
            Margin="10,5"
            ItemsSource="{Binding ElementName=parentControl, Path=Order.Breakdowns}">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <userControls:DisplayMachineBreakdown Breakdown="{Binding}" Margin="10,0" />
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
    </Grid>
</UserControl>
