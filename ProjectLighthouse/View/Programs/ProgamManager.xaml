<UserControl
    x:Class="ProjectLighthouse.View.Programs.ProgamManager"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:gif="https://github.com/XamlAnimatedGif/XamlAnimatedGif"
    xmlns:local="clr-namespace:ProjectLighthouse.View.Programs"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
    d:DesignWidth="1445"
    Background="{StaticResource Background}"
    Loaded="UserControl_Loaded"
    mc:Ignorable="d">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" MinWidth="280" />
            <ColumnDefinition Width="3*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="auto" />
            </Grid.ColumnDefinitions>
            <TextBox
                x:Name="searchBox"
                Style="{StaticResource SearchBox}"
                Text="{Binding SearchString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <Button
                x:Name="ClearButton"
                Grid.Column="1"
                Click="ClearButton_Click"
                Style="{StaticResource ClearButton}" />
        </Grid>

        <ListView
            Grid.Row="1"
            HorizontalContentAlignment="Stretch"
            d:ItemsSource="{d:SampleData ItemCount=10}"
            ItemsSource="{Binding FilteredPrograms, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
            ScrollViewer.CanContentScroll="false"
            SelectedValue="{Binding SelectedProgram, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid Margin="10,3">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            FontSize="16"
                            FontWeight="SemiBold"
                            Text="{Binding Name}" />
                        <TextBlock
                            Grid.Column="1"
                            Margin="5,0"
                            FontSize="16"
                            FontWeight="SemiBold"
                            Text="{Binding Description}" />
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <Grid Grid.Row="2" Margin="5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <TextBlock
                VerticalAlignment="Center"
                d:Text="PROGRAM_COUNT"
                Opacity="0.6"
                Text="{Binding FilteredPrograms.Count, StringFormat='{}{0} program(s)'}" />
            <!--<TextBlock
                Grid.Column="1"
                Margin="5,0,5,0"
                VerticalAlignment="Center"
                Text="Filter by:" />
            <ComboBox
                x:Name="filterComboBox"
                Grid.Column="2"
                Text="{Binding SelectedFilter, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                <ComboBoxItem Content="Active" IsSelected="True" />
                <ComboBoxItem Content="Last 14 Days" />
                <ComboBoxItem Content="My Requests" />
                <ComboBoxItem Content="Pending" />
                <ComboBoxItem Content="Accepted" />
                <ComboBoxItem Content="Declined" />
                <ComboBoxItem Content="All" />
            </ComboBox>
            <Button
                Grid.Column="3"
                Margin="5,0,0,0"
                Command="{Binding ExportCommand}"
                Style="{StaticResource CSVButton}" />-->
        </Grid>
        <StackPanel
            Grid.RowSpan="2"
            Grid.Column="2"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Visibility="{Binding SelectedProgram, Converter={StaticResource NullToVisibility}}">
            <TextBlock
                HorizontalAlignment="Center"
                FontSize="40"
                FontStyle="Italic"
                Opacity="0.6"
                Text="What is this?" />

            <Border
                Grid.Row="3"
                Grid.ColumnSpan="2"
                Canvas.Left="55"
                Canvas.Top="30"
                Width="auto"
                Margin="0,10"
                VerticalAlignment="Top"
                CornerRadius="18">
                <Border.Effect>
                    <DropShadowEffect
                        BlurRadius="20"
                        Direction="220"
                        Opacity="0.2"
                        ShadowDepth="20"
                        Color="Black" />
                </Border.Effect>
                <Border Name="ReceiverColor" CornerRadius="15">
                    <Grid MaxWidth="400" MaxHeight="300">
                        <Border
                            Name="Mask"
                            Background="{StaticResource Purple}"
                            CornerRadius="20" />
                        <Grid x:Name="image">
                            <Image
                                Name="Receiver"
                                MaxWidth="400"
                                MaxHeight="300"
                                gif:AnimationBehavior.AnimateInDesignMode="True"
                                gif:AnimationBehavior.RepeatBehavior="3"
                                gif:AnimationBehavior.SourceUri="pack://application:,,,/Resources/GIF/zoolander-what-is-this.gif"
                                RenderOptions.BitmapScalingMode="HighQuality" />
                            <Grid.OpacityMask>
                                <VisualBrush Visual="{Binding ElementName=Mask}" />
                            </Grid.OpacityMask>
                        </Grid>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Viewbox
                                MaxHeight="60"
                                Margin="20"
                                VerticalAlignment="Bottom">
                                <TextBlock Foreground="White" Text="{Binding SearchString, TargetNullValue='nothing found'}">
                                    <TextBlock.Effect>
                                        <DropShadowEffect
                                            BlurRadius="4"
                                            Opacity="0.8"
                                            ShadowDepth="0"
                                            Color="Black" />
                                    </TextBlock.Effect>
                                </TextBlock>
                            </Viewbox>

                            <Viewbox
                                Grid.Column="1"
                                MaxWidth="100"
                                Margin="0,0,20,40"
                                VerticalAlignment="Bottom">
                                <TextBlock Foreground="White" Text="Lighthouse">
                                    <TextBlock.Effect>
                                        <DropShadowEffect
                                            BlurRadius="4"
                                            Opacity="0.8"
                                            ShadowDepth="0"
                                            Color="Black" />
                                    </TextBlock.Effect>
                                </TextBlock>
                            </Viewbox>
                        </Grid>
                    </Grid>
                </Border>
            </Border>
            <TextBlock
                HorizontalAlignment="Center"
                FontSize="30"
                FontStyle="Italic"
                Opacity="0.6"
                Text="{Binding SearchString, StringFormat='{}A {0} for ants?!', TargetNullValue=''}" />
        </StackPanel>
        <ScrollViewer
            x:Name="scroller"
            Grid.RowSpan="3"
            Grid.Column="2"
            ScrollChanged="ScrollViewer_ScrollChanged"
            Visibility="{Binding SelectedProgram, Converter={StaticResource NotNullToVisibility}}">
            <Grid MaxWidth="700" Margin="25,20,25,50">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Border Background="White" CornerRadius="10">
                    <Border.Effect>
                        <DropShadowEffect
                            BlurRadius="30"
                            Opacity="0.4"
                            ShadowDepth="0"
                            Color="Black" />
                    </Border.Effect>
                </Border>

                <StackPanel Margin="25,15">
                    <!--  Card Header  -->
                    <TextBlock
                        d:Text="PROGRAM_NAME"
                        Style="{StaticResource title}"
                        Text="{Binding SelectedProgram.Name, StringFormat='{}Program {0}'}" />
                    <TextBlock
                        d:Text="PROGRAM_DESCRIPTION"
                        Style="{StaticResource subtitle}"
                        Text="{Binding SelectedProgram.Description}" />
                    <TextBlock
                        d:Text="PROGRAM_TAGS"
                        Style="{StaticResource subtitle}"
                        Text="{Binding SelectedProgram.Tags}" />

                    <ItemsControl
                        Margin="10"
                        ItemsSource="{Binding SelectedProgram.TagsList}"
                        Background="{StaticResource Background}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border
                                    Margin="5,3"
                                    Background="{StaticResource BlueFaded}"
                                    CornerRadius="5">
                                    <TextBlock
                                        Margin="5,3"
                                        FontWeight="SemiBold"
                                        Foreground="{StaticResource Blue}"
                                        Text="{Binding}" />
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>

                    <!--  MetaData Dates display grid  -->
                    <Grid Margin="15,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                        </Grid.RowDefinitions>

                        <!--<StackPanel Margin="0,5" Orientation="Horizontal">
                            <Path
                                Width="15"
                                Height="15"
                                Margin="0,2,5,0"
                                Data="M4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22V22H9A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2M12.19,5.5C11.3,5.5 10.59,5.68 10.05,6.04C9.5,6.4 9.22,7 9.27,7.69H11.24C11.24,7.41 11.34,7.2 11.5,7.06C11.7,6.92 11.92,6.85 12.19,6.85C12.5,6.85 12.77,6.93 12.95,7.11C13.13,7.28 13.22,7.5 13.22,7.8C13.22,8.08 13.14,8.33 13,8.54C12.83,8.76 12.62,8.94 12.36,9.08C11.84,9.4 11.5,9.68 11.29,9.92C11.1,10.16 11,10.5 11,11H13C13,10.72 13.05,10.5 13.14,10.32C13.23,10.15 13.4,10 13.66,9.85C14.12,9.64 14.5,9.36 14.79,9C15.08,8.63 15.23,8.24 15.23,7.8C15.23,7.1 14.96,6.54 14.42,6.12C13.88,5.71 13.13,5.5 12.19,5.5M11,12V14H13V12H11Z"
                                Fill="{StaticResource Purple}"
                                Stretch="Uniform" />
                            <TextBlock
                                FontSize="13"
                                FontStyle="Italic"
                                FontWeight="SemiBold"
                                Foreground="{StaticResource Purple}"
                                Opacity="0.8"
                                Text="{Binding SelectedRequest.RaisedBy, UpdateSourceTrigger=PropertyChanged, StringFormat='{}Raised by {0}', FallbackValue='Raised by Randy Marsh'}" />
                            <TextBlock
                                FontSize="13"
                                FontStyle="Italic"
                                FontWeight="SemiBold"
                                Foreground="{StaticResource Purple}"
                                Opacity="0.8"
                                Text="{Binding SelectedRequest.DateRaised, UpdateSourceTrigger=PropertyChanged, StringFormat='{} {0}', Converter={StaticResource modifiedFormatter}}" />
                        </StackPanel>-->
                        <!--<StackPanel
                            Grid.Row="1"
                            Margin="0,5"
                            Orientation="Horizontal"
                            Visibility="{Binding ModifiedVis, UpdateSourceTrigger=PropertyChanged}">
                            <Path
                                Width="15"
                                Height="15"
                                Margin="0,0,5,0"
                                Data="M21,10.12H14.22L16.96,7.3C14.23,4.6 9.81,4.5 7.08,7.2C4.35,9.91 4.35,14.28 7.08,17C9.81,19.7 14.23,19.7 16.96,17C18.32,15.65 19,14.08 19,12.1H21C21,14.08 20.12,16.65 18.36,18.39C14.85,21.87 9.15,21.87 5.64,18.39C2.14,14.92 2.11,9.28 5.62,5.81C9.13,2.34 14.76,2.34 18.27,5.81L21,3V10.12M12.5,8V12.25L16,14.33L15.28,15.54L11,13V8H12.5Z"
                                Fill="{StaticResource Blue}"
                                Stretch="Uniform" />

                            <TextBlock
                                Grid.Row="1"
                                FontSize="13"
                                FontStyle="Italic"
                                FontWeight="SemiBold"
                                Foreground="{StaticResource Blue}"
                                Opacity="0.8"
                                Text="{Binding SelectedRequest.ModifiedBy, StringFormat='{}Updated by {0}', UpdateSourceTrigger=PropertyChanged}" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="2"
                                HorizontalAlignment="Right"
                                d:Text="Updated by Kyle Brovloski yesterday"
                                FontSize="13"
                                FontStyle="Italic"
                                FontWeight="SemiBold"
                                Foreground="{StaticResource Blue}"
                                Opacity="0.8"
                                Text="{Binding SelectedRequest.LastModified, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource modifiedFormatter}, StringFormat='{} {0}'}" />
                        </StackPanel>

                        <StackPanel
                            Grid.Row="2"
                            Margin="0,5"
                            Orientation="Horizontal"
                            Visibility="{Binding SelectedRequest.IsDeclined, Converter={StaticResource boolToVisible}}">
                            <Path
                                Width="15"
                                Height="15"
                                Margin="0,0,5,0"
                                Data="M12,3A3,3 0 0,0 9,6C9,9 14,13 6,13A2,2 0 0,0 4,15V17H20V15A2,2 0 0,0 18,13C10,13 15,9 15,6C15,4 13.66,3 12,3M6,19V21H18V19H6Z"
                                Fill="{StaticResource Red}"
                                Stretch="Uniform" />

                            <TextBlock
                                d:Text="Declined - Uneconomical"
                                FontSize="13"
                                FontStyle="Italic"
                                FontWeight="SemiBold"
                                Foreground="{StaticResource Red}"
                                Opacity="0.8"
                                Text="{Binding SelectedRequest.Status, UpdateSourceTrigger=PropertyChanged}" />
                        </StackPanel>

                        <StackPanel
                            Grid.Row="3"
                            Margin="0,5"
                            Orientation="Horizontal"
                            Visibility="{Binding SelectedRequest.IsAccepted, Converter={StaticResource boolToVisible}}">
                            <Path
                                Width="15"
                                Height="15"
                                Margin="0,0,5,0"
                                Data="M12,3A3,3 0 0,0 9,6C9,9 14,13 6,13A2,2 0 0,0 4,15V17H20V15A2,2 0 0,0 18,13C10,13 15,9 15,6C15,4 13.66,3 12,3M6,19V21H18V19H6Z"
                                Fill="{StaticResource Green}"
                                Stretch="Uniform" />

                            <TextBlock
                                d:Text="Approved by Eric - M00000"
                                FontSize="13"
                                FontStyle="Italic"
                                FontWeight="SemiBold"
                                Foreground="{StaticResource Green}"
                                Opacity="0.8"
                                Text="{Binding SelectedRequest.Status, UpdateSourceTrigger=PropertyChanged}" />

                        </StackPanel>-->

                    </Grid>

                    <!--  Controls area  -->

                    <StackPanel Margin="10">

                        <Grid MinHeight="600">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <TextBlock
                                Margin="30,10"
                                FontFamily="pack://application:,,,/Resources/Font/#Montserrat"
                                FontWeight="SemiBold"
                                Foreground="{StaticResource Blue}"
                                Text="$1 MAIN SPINDLE" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="30,10"
                                FontFamily="pack://application:,,,/Resources/Font/#Montserrat"
                                FontWeight="SemiBold"
                                Foreground="{StaticResource Blue}"
                                Text="$2 SUB SPINDLE" />

                            <wv2:WebView2
                                x:Name="dollarOne"
                                Grid.Row="1"
                                Grid.Column="0"
                                Width="Auto"
                                Height="Auto"
                                d:Visibility="Visible" />

                            <wv2:WebView2
                                x:Name="dollarTwo"
                                Grid.Row="1"
                                Grid.Column="1"
                                Width="Auto"
                                Height="Auto"
                                d:Visibility="Visible" />
                        </Grid>

                    </StackPanel>

                    <TextBlock Style="{StaticResource section}" Text="Comments" />

                    <!--<uc:DisplayListOfNotes
                        MinHeight="80"
                        Notes="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}, Path=DataContext.FilteredNotes}"
                        ShowingEditControls="False" />-->
                    <Grid x:Name="composeMessageControls" Grid.Row="2">

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="auto" />
                        </Grid.ColumnDefinitions>
                        <TextBox
                            Style="{StaticResource MessageComposer}"
                            Text="{Binding NewMessage, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            TextChanged="TextBox_TextChanged"
                            TextWrapping="WrapWithOverflow" />
                        <Button
                            x:Name="SendButton"
                            Grid.Column="1"
                            Margin="10,0,0,0"
                            Background="Transparent"
                            Command="{Binding SendMessageCommand}"
                            IsEnabled="False"
                            Style="{StaticResource SendButton}" />

                    </Grid>
                </StackPanel>
            </Grid>
        </ScrollViewer>
        <Border
            x:Name="grad"
            Grid.Column="1"
            Height="20"
            VerticalAlignment="Top"
            CornerRadius="20,0,0,0"
            IsHitTestVisible="False">
            <Border.Background>
                <LinearGradientBrush Opacity="0.08" StartPoint="0,1" EndPoint="0,0">
                    <GradientStop Offset="0" Color="Transparent" />
                    <GradientStop Offset="1" Color="Gray" />
                </LinearGradientBrush>
            </Border.Background>
        </Border>
    </Grid>
</UserControl>
