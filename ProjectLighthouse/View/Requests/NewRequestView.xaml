<UserControl
    x:Class="ProjectLighthouse.View.Requests.NewRequestView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:System="clr-namespace:System;assembly=mscorlib"
    xmlns:converters="clr-namespace:ProjectLighthouse.ViewModel.ValueConverters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:gif="https://github.com/XamlAnimatedGif/XamlAnimatedGif"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:uc="clr-namespace:ProjectLighthouse.View.UserControls"
    d:Background="White"
    d:DesignHeight="758.58"
    d:DesignWidth="1179.077"
    SizeChanged="UserControl_SizeChanged"
    mc:Ignorable="d">
    <Grid>
        <Grid.Resources>
            <converters:boolToCollapsedOrVisible x:Key="hideIfTrue" />
            <converters:boolToVisibleOrCollapsed x:Key="showIfTrue" />
        </Grid.Resources>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition x:Name="analyticsCol" Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <TextBlock
            Grid.ColumnSpan="3"
            Margin="10"
            Style="{StaticResource title}"
            Text="Select a product to get started."
            Visibility="{Binding ProductIsSelected, Converter={StaticResource hideIfTrue}}" />
        <TextBlock
            Grid.ColumnSpan="3"
            Margin="10"
            Style="{StaticResource title}"
            Text="{Binding NewRequest.Product, StringFormat='{}New Request for {0}'}"
            Visibility="{Binding ProductIsSelected, Converter={StaticResource showIfTrue}}" />

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="auto" />
            </Grid.RowDefinitions>

            <TextBox
                Style="{StaticResource SearchBox}"
                Tag="search products"
                Text="{Binding SearchTerm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <TextBlock
                Grid.Row="1"
                Margin="10,0,0,0"
                d:Visibility="Hidden"
                Style="{StaticResource section}"
                Text="Search Results"
                Visibility="{Binding ShowingLiveRequirements, Converter={StaticResource hideIfTrue}}" />
            <StackPanel
                Grid.Row="1"
                Margin="10,0,0,0"
                Orientation="Horizontal"
                Visibility="{Binding ShowingLiveRequirements, Converter={StaticResource showIfTrue}}">
                <Border
                    Width="14"
                    Height="14"
                    VerticalAlignment="Center"
                    Background="{StaticResource Red}"
                    CornerRadius="7" />
                <TextBlock
                    Grid.Row="1"
                    Margin="10,0,0,2"
                    VerticalAlignment="Center"
                    Style="{StaticResource section}"
                    Text="Live Requirements" />
            </StackPanel>
            <ListView
                x:Name="ProductsListBox"
                Grid.Row="2"
                ItemsSource="{Binding FilteredList}"
                SelectedValue="{Binding SelectedProduct}"
                SelectionChanged="ListView_SelectionChanged">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <uc:DisplayTurnedProduct Product="{Binding Path=.}" />
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <StackPanel
                Grid.Row="2"
                Margin="50"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Visibility="{Binding NoSearchResults, Converter={StaticResource showIfTrue}}">
                <Border
                    x:Name="gifContainer"
                    Grid.Row="3"
                    Grid.ColumnSpan="2"
                    Canvas.Left="55"
                    Canvas.Top="30"
                    Width="auto"
                    Height="auto"
                    Margin="0,10"
                    VerticalAlignment="Top"
                    CornerRadius="18">
                    <Border.Effect>
                        <DropShadowEffect
                            BlurRadius="20"
                            Direction="220"
                            Opacity="0.2"
                            ShadowDepth="20"
                            Color="Black" />
                    </Border.Effect>
                    <Border Name="ReceiverColor" CornerRadius="15">
                        <Grid Opacity="0.5">
                            <Border
                                Name="Mask"
                                Background="{StaticResource Blue}"
                                CornerRadius="20" />
                            <StackPanel x:Name="image">
                                <Image
                                    Name="Receiver"
                                    MaxWidth="400"
                                    gif:AnimationBehavior.AnimateInDesignMode="True"
                                    gif:AnimationBehavior.SourceUri="pack://application:,,,/Resources/GIF/travolta.gif"
                                    RenderOptions.BitmapScalingMode="HighQuality" />
                                <StackPanel.OpacityMask>
                                    <VisualBrush Visual="{Binding ElementName=Mask}" />
                                </StackPanel.OpacityMask>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Border>
                <TextBlock
                    Margin="0,10,0,0"
                    HorizontalAlignment="Center"
                    FontSize="16"
                    Foreground="Black"
                    Opacity="0.2"
                    Text="No products found." />
            </StackPanel>


            <StackPanel
                Grid.Row="4"
                Orientation="Horizontal" HorizontalAlignment="Right">
                <TextBlock
                    Margin="0,0,5,4"
                    VerticalAlignment="Center"
                    FontWeight="SemiBold"
                    Opacity="0.4"
                    Text="Need something else?" />
                <Button
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Style="{StaticResource Action_New_Button}"
                    Command="{Binding AddSpecialCommand}"
                    Tag="Add Bespoke Item" />
            </StackPanel>


        </Grid>

        <StackPanel Grid.Row="1" Grid.Column="1">
            <Border
                Margin="5"
                Background="{StaticResource Surface}"
                CornerRadius="8">
                <Grid Margin="20,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <TextBlock
                        Grid.ColumnSpan="2"
                        Margin="0,0,0,5"
                        d:Text="PRODUCT_NAME"
                        FontWeight="SemiBold"
                        Style="{StaticResource section}"
                        Text="{Binding SelectedProduct.ProductName}" />

                    <Border  Grid.Row="1" Height="120" Width="120" Background="{StaticResource Background}" CornerRadius="5">
                        <Grid>
                        <Path
                            Height="40"
                            Margin="0,0,2,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Data="M1,10V2L10,5V7L1,10M8,10V8H13V4H8V3L12,1L16,3V4H15V8H16V10H14.74L8.44,13.64L9,10H8M7,23L7.04,22.76L16.15,17.5L16.67,20.88L13,23H7M8.05,16.17L15.31,12L15.83,15.37L7.43,20.22L8.05,16.17Z"
                            Fill="{StaticResource OnBackground}"
                            Opacity="0.3"
                            Stretch="Uniform" />
                        <Image
                            RenderOptions.BitmapScalingMode="Fant"
                            Source="{Binding SelectedProduct.Group.LocalRenderPath}" />
                    </Grid>
                    </Border>

                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        Margin="10,0,0,0"
                        TextElement.FontFamily="Consolas">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Text="In Stock" />
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            d:Text="QTY_IN_STOCK"
                            FontWeight="SemiBold"
                            Text="{Binding SelectedProduct.QuantityInStock, StringFormat='{}{0:#,##0} pcs'}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Text="On Sales Order" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            d:Text="QTY_ON_SO"
                            FontWeight="SemiBold"
                            Text="{Binding SelectedProduct.QuantityOnSO, StringFormat='{}{0:#,##0} pcs'}" />

                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="0"
                            Text="On Purchase Order" />
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            d:Text="QTY_ON_PO"
                            FontWeight="SemiBold"
                            Text="{Binding SelectedProduct.QuantityOnPO, StringFormat='{}{0:#,##0} pcs'}" />

                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="0"
                            Text="Tooling Group" />
                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            d:Text="TOOLING_GROUP"
                            FontWeight="SemiBold"
                            Text="{Binding SelectedProduct.ProductGroup}" />

                        <TextBlock
                            Grid.Row="4"
                            Grid.Column="0"
                            Text="Material" />
                        <TextBlock
                            Grid.Row="4"
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            d:Text="MATERIAL"
                            FontWeight="SemiBold"
                            Text="{Binding SelectedProduct.Material}" />

                        <TextBlock
                            Grid.Row="5"
                            Grid.Column="0"
                            Text="Target Stock" />
                        <TextBlock
                            Grid.Row="5"
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            d:Text="TARGET_STOCK"
                            FontWeight="SemiBold"
                            Text="{Binding SelectedProduct.TargetStock, StringFormat='{}{0:#,##0} pcs'}" />

                        <TextBlock
                            Grid.Row="6"
                            Grid.Column="0"
                            Text="Guaranteed" />
                        <TextBlock
                            Grid.Row="6"
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            d:Text="QTY_GUARANTEED"
                            FontWeight="SemiBold"
                            Text="{Binding SelectedProduct.LighthouseGuaranteedQuantity, StringFormat='{}{0:#,##0} pcs'}" />

                        <TextBlock
                            Grid.Row="7"
                            Grid.Column="0"
                            Text="Total Manufactured" />
                        <TextBlock
                            Grid.Row="7"
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            d:Text="QTY_MANUFACTURED"
                            FontWeight="SemiBold"
                            Text="{Binding SelectedProduct.QuantityManufactured, StringFormat='{}{0:#,##0} pcs'}" />
                    </Grid>
                </Grid>
            </Border>
            <TextBlock Style="{StaticResource section}" Text="Customer's Required Quantity" />

            <TextBox
                x:Name="quantityTextBox"
                Style="{StaticResource DefaultTextBox}"
                Tag="Quantity"
                Text="{Binding NewRequest.QuantityRequired, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                TextChanged="TextBox_TextChanged" />
            <TextBlock Style="{StaticResource section}" Text="Customer's Required Date" />
            <DatePicker
                x:Name="requiredDatePicker"
                Margin="5"
                DisplayDateStart="{Binding Mode=OneWay, Source={x:Static System:DateTime.Today}}"
                SelectedDate="{Binding NewRequest.DateRequired}"
                SelectedDateChanged="requiredDatePicker_SelectedDateChanged" />
            <Border
                x:Name="LeadTimesGrid"
                Margin="5"
                Background="{StaticResource Surface}"
                CornerRadius="5">
                <StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <Path
                            Margin="12,5,0,7"
                            VerticalAlignment="Center"
                            Data="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
                            Fill="{StaticResource Blue}">
                            <Path.ToolTip>
                                <TextBlock
                                    MaxWidth="500"
                                    Margin="20,0"
                                    FontSize="16"
                                    Text="Scheduling isn't run on a FIFO basis- a product could be significantly faster or slower depending on how it fits in with existing orders on the schedule."
                                    TextWrapping="Wrap" />

                            </Path.ToolTip>
                        </Path>
                        <TextBlock
                            Margin="5,5,5,7"
                            VerticalAlignment="Center"
                            FontSize="20"
                            Foreground="{StaticResource OnSurface}"
                            Text="Our estimated lead times" />
                    </StackPanel>
                    <Grid>
                        <ListView
                            Margin="15,0,15,5"
                            d:ItemsSource="{d:SampleData ItemCount=4}"
                            Background="Transparent"
                            BorderBrush="Transparent"
                            ItemsSource="{Binding Lathes}"
                            Style="{x:Null}">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="10,5">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock
                                                VerticalAlignment="Center"
                                                d:Text="C00"
                                                FontFamily="Consolas"
                                                FontSize="18"
                                                FontWeight="SemiBold"
                                                Text="{Binding Lathe.Id}" />
                                            <TextBlock
                                                Margin="5,0,0,0"
                                                VerticalAlignment="Center"
                                                Foreground="{StaticResource Purple}"
                                                Style="{StaticResource statement}">
                                                <Run Text="{Binding Lathe.Make}" />
                                                <Run Text="{Binding Lathe.Model}" />
                                            </TextBlock>
                                        </StackPanel>
                                        <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                                            <Border
                                                Margin="10,0"
                                                VerticalAlignment="Center"
                                                BorderBrush="{StaticResource Orange}"
                                                BorderThickness="2,0,0,0"
                                                CornerRadius="3"
                                                Visibility="{Binding IsHigh, Converter={StaticResource showIfTrue}}">
                                                <Grid>
                                                    <Border
                                                        Background="{StaticResource Orange}"
                                                        CornerRadius="3"
                                                        Opacity="0.15" />
                                                    <TextBlock
                                                        Margin="7,2"
                                                        FontSize="12"
                                                        FontWeight="SemiBold"
                                                        Foreground="{StaticResource Orange}"
                                                        Text="Elevated" />
                                                </Grid>
                                            </Border>
                                            <TextBlock
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Center"
                                                FontSize="16"
                                                FontWeight="SemiBold"
                                                Text="{Binding DisplayLeadTime}" />
                                        </StackPanel>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                        <Rectangle Fill="#01ffffff" />
                    </Grid>

                </StackPanel>
            </Border>
            <Button
                x:Name="SubmitButton"
                HorizontalAlignment="Right"
                Style="{StaticResource Action_Button}"
                Command="{Binding SubmitRequestCommand}"
                Tag="Submit Request"
                IsEnabled="False" />
        </StackPanel>
        <Border
            Grid.Row="1"
            Grid.Column="2"
            Margin="10"
            Background="{StaticResource Surface}"
            CornerRadius="10">
            <StackPanel VerticalAlignment="Center">
                <Image
                    Width="200"
                    Margin="0,0,0,10"
                    RenderOptions.BitmapScalingMode="HighQuality"
                    Source="/Resources/LighthouseLogo_Mono.png" />
                <TextBlock
                    HorizontalAlignment="Center"
                    Foreground="{StaticResource Teal}"
                    Style="{StaticResource subtitle}"
                    Text="Request Analytics" />
                <TextBlock
                    HorizontalAlignment="Center"
                    Foreground="{StaticResource Teal}"
                    Opacity="0.6"
                    Style="{StaticResource subsubtitle}"
                    Text="Coming soon" />
            </StackPanel>
        </Border>
        <!--<StackPanel Grid.Row="1" Grid.Column="2">
            <TextBlock
                FontSize="25"
                Style="{StaticResource subtitle}"
                Text="Analytics" />
            <TextBlock
                Style="{StaticResource section}"
                Text="Here's how Lighthouse would build the order:"
                TextWrapping="Wrap" />
            <Grid>
                <ListView ItemsSource="{Binding RecommendedManifest}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <uc:DisplayManifestItem Margin="10,2" Item="{Binding}" />
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
                <Rectangle Fill="#01ffffff" />
            </Grid>
            <StackPanel
                Margin="10,0"
                HorizontalAlignment="Right"
                Orientation="Horizontal">
                <TextBlock
                    VerticalAlignment="Center"
                    FontSize="11"
                    Opacity="0.25"
                    Text="Lighthouse Requests Engine" />
                <Path
                    Width="12"
                    Height="12"
                    Margin="3,1,0,0"
                    Data="M12 3C7.03 3 3 7.03 3 12S7.03 21 12 21C14 21 15.92 20.34 17.5 19.14L16.06 17.7C14.87 18.54 13.45 19 12 19C8.13 19 5 15.87 5 12S8.13 5 12 5 19 8.13 19 12H16L20 16L24 12H21C21 7.03 16.97 3 12 3M7.71 13.16C7.62 13.23 7.59 13.35 7.64 13.45L8.54 15C8.6 15.12 8.72 15.12 8.82 15.12L9.95 14.67C10.19 14.83 10.44 14.97 10.7 15.09L10.88 16.28C10.9 16.39 11 16.47 11.1 16.47H12.9C13 16.5 13.11 16.41 13.13 16.3L13.31 15.12C13.58 15 13.84 14.85 14.07 14.67L15.19 15.12C15.3 15.16 15.42 15.11 15.47 15L16.37 13.5C16.42 13.38 16.39 13.26 16.31 13.19L15.31 12.45C15.34 12.15 15.34 11.85 15.31 11.55L16.31 10.79C16.4 10.72 16.42 10.61 16.37 10.5L15.47 8.95C15.41 8.85 15.3 8.81 15.19 8.85L14.07 9.3C13.83 9.13 13.57 9 13.3 8.88L13.13 7.69C13.11 7.58 13 7.5 12.9 7.5H11.14C11.04 7.5 10.95 7.57 10.93 7.67L10.76 8.85C10.5 8.97 10.23 9.12 10 9.3L8.85 8.88C8.74 8.84 8.61 8.89 8.56 9L7.65 10.5C7.6 10.62 7.63 10.74 7.71 10.81L8.71 11.55C8.69 11.7 8.69 11.85 8.71 12C8.7 12.15 8.7 12.3 8.71 12.45L7.71 13.19M12 13.5H12C11.16 13.5 10.5 12.82 10.5 12C10.5 11.17 11.17 10.5 12 10.5S13.5 11.17 13.5 12 12.83 13.5 12 13.5"
                    Fill="Black"
                    Opacity="0.25"
                    Stretch="Uniform" />
            </StackPanel>
            <TextBlock Text="And here's how we would cost that:" />

        </StackPanel>-->
    </Grid>
</UserControl>
